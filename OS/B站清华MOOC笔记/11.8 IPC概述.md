# 11.8 IPC概述

* 为什么要进行进程间通信：因为大的任务需要多个进程之间协作完成，在保证进程相对独立性的情况下，需要进行进程间的通信。
* IPC facility 提供两个操作：
    * send(message) 消息大小固定或可变
    * receive(message)
* 如果P和Q想通信
    * 需要在他们之间建立通信链路
        * 物理方式：如共享内存，硬件总线
        * 逻辑方式：逻辑属性
    * 通过 send / receive 交换信息

### 直接通信

* 进程必须正确命名对方：通过进程ID确定发送/接收信息的进程是哪一个
    * send(Q, message) - 发送信息到进程Q
    * receive(P, message) - 从进程P接受信息
* 通信链路属性：
    * 自动建立链路
    * 一条链路对应一对通信进程
    * 每对通信进程间只有一个链接存在
    * 链接可以是单向的，一般是双向的

### 间接通信

* 通过内核中消息队列完成
    * 每个消息队列都有唯一的ID
    * 进程间共享一个消息队列，才能够通信
* 通信链路的属性：
    * 只有进程共享同一个消息队列，进程才能通信
    * 链接可以与许多进程相关联
    * 每对进程可以共享多个通信链路
    * 链接可以是单向，也可以是双向
* 操作：
    * 创建一个新的消息队列
    * 通过消息队列发送和接受信息：send(A, message) - 发送消息到队列A； receive(A, message) - 从消息队列 A 接受信息

### 消息传递可以是阻塞或非阻塞

* 阻塞被认为是同步的
* 非阻塞被认为是异步的

### 信息缓存

* 队列的消息被附加到链路（存在消息缓冲区）
* 缓冲区的容量，三种情况：
    * 0容量：相等于发送方要等待接收方，要等待接收方收到信息，发送方的send才能返回，否则信息丢失。类比于阻塞（同步）发送方式。
    * 有限容量
        * 在缓冲区未满前，发送方可以发送完消息即返回。缓冲区满后，发送方需要等待
        * 缓冲区不为空，接收方可以直接取信息不需要等待。缓冲区为空，则需要等待发送方发送信息。
    * 无限容量：发送方完全不需要等，接收方在缓冲区为空时需要等待